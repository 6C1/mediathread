{% extends "base.html" %}
{% load user_annotations tagging_tags smartif user_projects threadedcomments_tags %}

<title> {% block title %}
{% if is_space_owner %}
    My Projects > 
    {% if project.title %}{{project.title}}{% else %}New project{% endif %}
{% else %}
    Class Analysis > 
    {{space_owner.username}}'s Projects > 
    {% if project.title %}{{project.title}}{% else %}New project{% endif %}
{% endif %}
{% endblock %}</title>

{% block css %}
<link rel="stylesheet" href="/site_media/css/project.css" />  
{% endblock %}

{% block js %}
  <script type="text/javascript" src="/site_media/js/mochikit/MochiKit/MochiKit.js"></script>
  <script type="text/javascript" src="/site_media/js/hs.js"></script>
  <script type="text/javascript" src="/site_media/js/tablesort.js"></script>
  <script type="text/javascript" src="/site_media/js/vital3/assetwindow.js"></script>
  <script type="text/javascript" src="/site_media/js/sherdjs/lib/tiny_mce3/jscripts/tiny_mce/tiny_mce.js"></script>
  
  
  <script type="text/javascript" src="/site_media/js/discussion.js"></script>

  <!--All the annotation javascript/css -->
  {% include "djangosherd/annotator_resources.html" %}

  <script type="text/javascript">        
    DjangoSherd_Project_Config(/*no_open_from_hash=*/ true);           
  </script>
  <!--END for showing Annotations -->
  
{% endblock %}

{% block content %}
{{ block.super }}
  
<h1>Discussion of {{root_comment.content_object.get_parent.content_object}}</h1><br />

      <div id="project_heading">
	<br />
<div id="asset_browse_col" class="asset-table">
  <h2>Your Saved Items</h2>
  <div id="materials">
    {% include "assetmgr/asset_table.html" %}
  </div>
</div>
  <div class="essay-space">
    <p>
	<h2>Discussion:</h2>
	  <div id="threadedcomments">
        {%get_comment_list for root_comment.content_object as comment_list%}
        {% for current_comment in comment_list|fill_tree|annotate_tree %}
            <!-- starting comment: >{{ current_comment.id }}-->
            {% ifchanged current_comment.parent_id %}
            {% else %}
                </li>
            {% endifchanged %}
            {% if not current_comment.open and not current_comment.close %}
                </li>
            {% endif %}
            {% if current_comment.open %}
                <ul >
            {% endif %}
            <li{% if current_comment.last %} class="last"{% endif %}>
            {{ current_comment.name }} said:
            <!-- ( #{{ current_comment.id }}): -->
            <p class ="threaded_comment_text">
            {{current_comment.comment|safe}}
            </p>
                <div class="respond_to_comment_form_div" id="respond_to_comment_form_div_id_{{current_comment.id}}">
                <p class = "respond_prompt" title="Click to show or hide the comment form">
                Respond<!-- to comment {{ current_comment.id }}: -->
                </p>
                {% get_comment_form for root_comment.content_object as current_comment_form with current_comment.id %}
                <form method="POST" action="/comments/post/" class="threaded_comments_form">
                    <ul>
                        {{ current_comment_form.as_ul }}
                        <li><input type="submit" value="Submit Comment" /></li>
                    </ul>
                </form>
                </div>
            {% if current_comment.added_path %} ADDED {% endif %}
            {% for close in current_comment.close %}
                </li>
                </ul>
            {% endfor %}
            
        {% endfor %}        
        
      </p>
      
   </div>


                    
      </div>

{% endblock %}
